this is some very difficult code that I wrote that too 6 weeks to write.